# 21. JDBC (Java Database Connectivity)

## ë“œë¼ì´ë²„ ë¡œë”©ê³¼ ì—°ê²°

Javaì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì—°ê²°í•˜ë ¤ë©´ JDBC(Java Database Connectivity)ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤. JDBCëŠ” ìë°” í”„ë¡œê·¸ë¨ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” **API** ì§‘í•©ì´ê³ , ê·¸ ì²« ë²ˆì§¸ ë‹¨ê³„ê°€ ë°”ë¡œ **ë“œë¼ì´ë²„ ë¡œë”©ê³¼ ì—°ê²°(connection)** ë‹¨ê³„ì´ë‹¤. ì•„ë˜ì— ê·¸ ê³¼ì •ì„ êµ¬ì²´ì ìœ¼ë¡œ ì„¤ëª…í•œë‹¤.

### âœ… 1. JDBC ë“œë¼ì´ë²„ë€?

- DBMS(Oracle, MySQL, PostgreSQL ë“±)ë§ˆë‹¤ JDBC ë“œë¼ì´ë²„ê°€ í•„ìš”í•¨
- ë“œë¼ì´ë²„ëŠ” ìë°”ì™€ DB ì‚¬ì´ì—ì„œ **í†µì‹ ì„ ì¤‘ê°œ**í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ (.jar íŒŒì¼)
- ë³´í†µ ë‹¤ìŒ ê²½ë¡œì—ì„œ ì œê³µë¨:
  - MySQL: `mysql-connector-java`
  - PostgreSQL: `postgresql.jar`
  - Oracle: `ojdbc11.jar`

------

### âœ… 2. ë“œë¼ì´ë²„ ë¡œë”© ë°©ì‹

#### ğŸ“Œ ë°©ë²• 1: `Class.forName()` ì‚¬ìš© (ì „í†µì ì¸ ë°©ì‹)

```
Class.forName("com.mysql.cj.jdbc.Driver");
```

- JVMì´ í´ë˜ìŠ¤ ë¡œë”© ì‹œ ë“œë¼ì´ë²„ ë“±ë¡ (`DriverManager.registerDriver()` í˜¸ì¶œë¨)
- Java 6 ì´í›„ëŠ” ìƒëµ ê°€ëŠ¥ (ì„œë¹„ìŠ¤ í”„ë¡œë°”ì´ë” ë©”ì»¤ë‹ˆì¦˜ì´ ëŒ€ì‹  ì²˜ë¦¬)

------

#### ğŸ“Œ ë°©ë²• 2: ìë™ ë¡œë”© (Java 6 ì´ìƒ)

JDBC 4.0 ì´í›„ë¶€í„°ëŠ” ë“œë¼ì´ë²„ `.jar` íŒŒì¼ì— `META-INF/services/java.sql.Driver` íŒŒì¼ì´ ì¡´ì¬í•˜ë©´, JVMì´ ìë™ìœ¼ë¡œ ë“œë¼ì´ë²„ í´ë˜ìŠ¤ë¥¼ ë¡œë”©í•¨.

- ì¦‰, `Class.forName()` ìƒëµ ê°€ëŠ¥
- ë‹¨, ë“œë¼ì´ë²„ `.jar` íŒŒì¼ì´ **classpath** ë˜ëŠ” **ëª¨ë“ˆ ê²½ë¡œ**ì— í¬í•¨ë¼ì•¼ í•¨

------

### âœ… 3. ì—°ê²°(Connection) ì—´ê¸°

#### ğŸ“Œ `DriverManager.getConnection()` ì‚¬ìš©

```
String url = "jdbc:mysql://localhost:3306/mydb";
String user = "root";
String password = "1234";

Connection conn = DriverManager.getConnection(url, user, password);
```

- ì—°ê²° ì„±ê³µ ì‹œ `Connection` ê°ì²´ ë°˜í™˜
- DB URLì€ ë‹¤ìŒ í˜•ì‹ì„ ë”°ë¦„:

| DBMS       | URL í˜•ì‹ ì˜ˆì‹œ                                   |
| ---------- | ----------------------------------------------- |
| MySQL      | `jdbc:mysql://host:port/dbname`                 |
| PostgreSQL | `jdbc:postgresql://host:port/dbname`            |
| Oracle     | `jdbc:oracle:thin:@host:port:sid` or `:service` |

------

### âœ… 4. ì—°ê²°ì— ì‹¤íŒ¨í•˜ëŠ” ê²½ìš°

- ë“œë¼ì´ë²„ `.jar`ê°€ ëˆ„ë½ëœ ê²½ìš° â†’ `ClassNotFoundException`
- DB ì ‘ê·¼ ë¶ˆê°€, URL ì˜¤íƒ€ â†’ `SQLException`
- ì¸ì¦ ì‹¤íŒ¨ â†’ `Access denied` ì˜¤ë¥˜

------

### âœ… 5. ì „ì²´ ì˜ˆì œ

```
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

public class DBConnectExample {
    public static void main(String[] args) {
        String url = "jdbc:mysql://localhost:3306/mydb";
        String user = "root";
        String password = "1234";

        try {
            // Class.forName("com.mysql.cj.jdbc.Driver"); // ìƒëµ ê°€ëŠ¥ (JDBC 4.0 ì´ìƒ)
            Connection conn = DriverManager.getConnection(url, user, password);
            System.out.println("âœ… ì—°ê²° ì„±ê³µ!");
            conn.close();
        } catch (SQLException e) {
            System.out.println("âŒ ì—°ê²° ì‹¤íŒ¨: " + e.getMessage());
        }
    }
}
```

------

### âœ… 6. ì—°ê²° í›„ í•´ì•¼ í•  ì¼

1. **Statement/PreparedStatement** ìƒì„±
2. **SQL ì‹¤í–‰**
3. **ResultSet ì²˜ë¦¬**
4. **ìì› í•´ì œ (`close()`)**

â†’ ì´ ë¶€ë¶„ì€ ì´í›„ ë‹¨ê³„ì¸ `SQL ì‹¤í–‰`, `ResultSet ì²˜ë¦¬`, `íŠ¸ëœì­ì…˜ ê´€ë¦¬`ì—ì„œ ìì„¸íˆ ì„¤ëª…í• ê²Œ.

## SQL ì‹¤í–‰ (`Statement`, `PreparedStatement`)

Javaì—ì„œ SQLì„ ì‹¤í–‰í•˜ë ¤ë©´ `Statement` ë˜ëŠ” `PreparedStatement` ê°ì²´ë¥¼ ì‚¬ìš©í•œë‹¤.
 ì´ ë‘ ê°€ì§€ëŠ” JDBCì—ì„œ **SQL ëª…ë ¹ì–´ë¥¼ DBë¡œ ì „ì†¡í•˜ê³  ê²°ê³¼ë¥¼ ë°›ì•„ì˜¤ëŠ” í•µì‹¬ ë„êµ¬**ì´ë‹¤. 

### âœ… 1. `Statement`

#### ê°œìš”

- SQLì„ ë¬¸ìì—´ë¡œ ì‘ì„±í•´ì„œ ì‹¤í–‰
- ë™ì ìœ¼ë¡œ ì¿¼ë¦¬ë¥¼ ìƒì„±í•  ìˆ˜ ìˆì§€ë§Œ, **ë³´ì•ˆìƒ ìœ„í—˜(SQL Injection)** ì¡´ì¬

#### ì˜ˆì‹œ

```
Statement stmt = conn.createStatement();
String sql = "SELECT * FROM users WHERE username = 'admin'";
ResultSet rs = stmt.executeQuery(sql);
```

#### ì£¼ìš” ë©”ì„œë“œ

| ë©”ì„œë“œ                      | ì„¤ëª…                                                   |
| --------------------------- | ------------------------------------------------------ |
| `executeQuery(String sql)`  | SELECT ë¬¸ ì‹¤í–‰, `ResultSet` ë°˜í™˜                       |
| `executeUpdate(String sql)` | INSERT, UPDATE, DELETE ì‹¤í–‰, ì˜í–¥ë°›ì€ í–‰ ìˆ˜ ë°˜í™˜       |
| `execute(String sql)`       | ëª¨ë“  SQL ì‹¤í–‰ ê°€ëŠ¥. ê²°ê³¼ê°€ `ResultSet`ì´ë©´ `true` ë°˜í™˜ |

------

### âœ… 2. `PreparedStatement`

#### ê°œìš”

- **ë¯¸ë¦¬ ì»´íŒŒì¼ëœ SQL í…œí”Œë¦¿ì„ ì‚¬ìš©**, íŒŒë¼ë¯¸í„° ë°”ì¸ë”© ê°€ëŠ¥
- SQL Injection ë°©ì§€, ì„±ëŠ¥ ê°œì„ , ê°€ë…ì„± í–¥ìƒ

#### ë¬¸ë²•

```
String sql = "SELECT * FROM users WHERE username = ?";
PreparedStatement pstmt = conn.prepareStatement(sql);
pstmt.setString(1, "admin");
ResultSet rs = pstmt.executeQuery();
```

> `?`ëŠ” **1-based index**ë¡œ ë°”ì¸ë”©ë¨ (`setXXX(index, value)`)

------

#### ë‹¤ì–‘í•œ íƒ€ì… ë°”ì¸ë”©

| ë©”ì„œë“œ                        | ì„¤ëª…             |
| ----------------------------- | ---------------- |
| `setString(int, String)`      | ë¬¸ìì—´ ë°”ì¸ë”©    |
| `setInt(int, int)`            | ì •ìˆ˜ ë°”ì¸ë”©      |
| `setDouble(int, double)`      | ì‹¤ìˆ˜ ë°”ì¸ë”©      |
| `setDate(int, java.sql.Date)` | ë‚ ì§œ ë°”ì¸ë”©      |
| `setObject(int, Object)`      | ë²”ìš© íƒ€ì… ë°”ì¸ë”© |

------

### âœ… 3. ì˜ˆì œ: `INSERT`, `UPDATE`, `DELETE`

```
String sql = "INSERT INTO users (username, age) VALUES (?, ?)";
PreparedStatement pstmt = conn.prepareStatement(sql);
pstmt.setString(1, "alice");
pstmt.setInt(2, 25);

int affectedRows = pstmt.executeUpdate();
System.out.println("ğŸŸ¢ ì‚½ì…ëœ í–‰ ìˆ˜: " + affectedRows);
```

------

### âœ… 4. ì˜ˆì œ: SELECT + ê²°ê³¼ ì²˜ë¦¬

```
String sql = "SELECT * FROM users WHERE age > ?";
PreparedStatement pstmt = conn.prepareStatement(sql);
pstmt.setInt(1, 18);

ResultSet rs = pstmt.executeQuery();
while (rs.next()) {
    int id = rs.getInt("id");
    String name = rs.getString("username");
    int age = rs.getInt("age");
    System.out.printf("ID: %d, ì´ë¦„: %s, ë‚˜ì´: %d\n", id, name, age);
}
```

------

### âœ… 5. Statement vs PreparedStatement ìš”ì•½ ë¹„êµ

| í•­ëª©               | `Statement`     | `PreparedStatement` |
| ------------------ | --------------- | ------------------- |
| SQL ì‘ì„± ë°©ì‹      | ë¬¸ìì—´ ì¡°í•©     | í…œí”Œë¦¿ + íŒŒë¼ë¯¸í„°   |
| SQL Injection ë°©ì§€ | âŒ ìœ„í—˜í•¨        | âœ… ì•ˆì „              |
| ì„±ëŠ¥               | ì¿¼ë¦¬ë§ˆë‹¤ ì»´íŒŒì¼ | ì¿¼ë¦¬ ì¬ì‚¬ìš© ê°€ëŠ¥    |
| ê°€ë…ì„±             | ë‚®ìŒ            | ë†’ìŒ                |
| ì¶”ì²œ ìš©ë„          | ë‹¨ìˆœ í…ŒìŠ¤íŠ¸     | ì‹¤ë¬´ ì „ë°˜ì— ì‚¬ìš©    |

------

### âœ… 6. ì°¸ê³ : íŠ¸ëœì­ì…˜ ì²˜ë¦¬ì™€ í•¨ê»˜ ì‚¬ìš©í•˜ê¸°

```
conn.setAutoCommit(false);

try {
    PreparedStatement pstmt1 = conn.prepareStatement("INSERT INTO orders VALUES (?, ?)");
    pstmt1.setInt(1, 1);
    pstmt1.setString(2, "book");
    pstmt1.executeUpdate();

    PreparedStatement pstmt2 = conn.prepareStatement("UPDATE stock SET qty = qty - 1 WHERE item = ?");
    pstmt2.setString(1, "book");
    pstmt2.executeUpdate();

    conn.commit();
} catch (SQLException e) {
    conn.rollback();
}
```

## íŠ¸ëœì­ì…˜ ì²˜ë¦¬

Javaì—ì„œ **íŠ¸ëœì­ì…˜(Transaction)** ì€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì¼ë ¨ì˜ ì‘ì—…ì´ **ëª¨ë‘ ì„±ê³µí•˜ê±°ë‚˜ ëª¨ë‘ ì‹¤íŒ¨í•´ì•¼ í•˜ëŠ” ì›ìì  ë‹¨ìœ„**ë¡œ ì²˜ë¦¬ë˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. JDBCì—ì„œ íŠ¸ëœì­ì…˜ì„ ë‹¤ë£° ë•ŒëŠ” `Connection` ê°ì²´ë¥¼ í†µí•´ ì œì–´í•˜ë©°, **ìë™ ì»¤ë°‹ì„ ë„ê³  ìˆ˜ë™ìœ¼ë¡œ commit/rollback**ì„ ìˆ˜í–‰í•´ì•¼ í•œë‹¤.

------

### âœ… 1. íŠ¸ëœì­ì…˜ ê¸°ë³¸ êµ¬ì¡°

```
Connection conn = DriverManager.getConnection(...);
conn.setAutoCommit(false); // ìë™ ì»¤ë°‹ í•´ì œ

try {
    // ì—¬ëŸ¬ SQL ì‘ì—… ìˆ˜í–‰
    PreparedStatement pstmt1 = conn.prepareStatement(...);
    pstmt1.executeUpdate();

    PreparedStatement pstmt2 = conn.prepareStatement(...);
    pstmt2.executeUpdate();

    conn.commit(); // ëª¨ë“  ì‘ì—…ì´ ì„±ê³µí•˜ë©´ ì»¤ë°‹
} catch (SQLException e) {
    conn.rollback(); // ì—ëŸ¬ ë°œìƒ ì‹œ ë¡¤ë°±
} finally {
    conn.close();
}
```

------

### âœ… 2. `setAutoCommit(false)` ì˜ë¯¸

- ê¸°ë³¸ì ìœ¼ë¡œ JDBCëŠ” `setAutoCommit(true)`ë¡œ ì„¤ì •ë˜ì–´ ìˆìŒ â†’ ì¿¼ë¦¬ ì‹¤í–‰ë§ˆë‹¤ ìë™ ì»¤ë°‹ë¨
- `false`ë¡œ ë°”ê¾¸ë©´ `commit()` í˜¸ì¶œ ì „ê¹Œì§€ëŠ” ì‹¤ì œë¡œ DBì— ë°˜ì˜ë˜ì§€ ì•ŠìŒ
- **rollback()** í˜¸ì¶œ ì‹œ, ëª¨ë“  ë³€ê²½ ì‚¬í•­ì„ ì›ë˜ëŒ€ë¡œ ë˜ëŒë¦¼

------

### âœ… 3. ì˜ˆì œ: ì£¼ë¬¸ ì²˜ë¦¬ íŠ¸ëœì­ì…˜

```
String orderSQL = "INSERT INTO orders (user_id, product_id) VALUES (?, ?)";
String stockSQL = "UPDATE products SET stock = stock - 1 WHERE id = ?";

Connection conn = DriverManager.getConnection(url, user, password);
conn.setAutoCommit(false); // íŠ¸ëœì­ì…˜ ì‹œì‘

try {
    // ì£¼ë¬¸ ì¶”ê°€
    PreparedStatement orderStmt = conn.prepareStatement(orderSQL);
    orderStmt.setInt(1, 1);
    orderStmt.setInt(2, 101);
    orderStmt.executeUpdate();

    // ì¬ê³  ê°ì†Œ
    PreparedStatement stockStmt = conn.prepareStatement(stockSQL);
    stockStmt.setInt(1, 101);
    stockStmt.executeUpdate();

    conn.commit(); // ì„±ê³µ ì‹œ ì»¤ë°‹
    System.out.println("âœ… ì£¼ë¬¸ ì²˜ë¦¬ ì™„ë£Œ");
} catch (SQLException e) {
    conn.rollback(); // ì‹¤íŒ¨ ì‹œ ë¡¤ë°±
    System.out.println("âŒ ì£¼ë¬¸ ì‹¤íŒ¨, ë¡¤ë°± ì²˜ë¦¬ë¨");
} finally {
    conn.setAutoCommit(true); // ë‹¤ì‹œ ê¸°ë³¸ê°’ìœ¼ë¡œ ë³µì›
    conn.close();
}
```

------

### âœ… 4. ì˜ˆì™¸ ë°œìƒ ì‹œ ì£¼ì˜í•  ì 

- `SQLException`ë§Œ ì¡ì§€ ë§ê³ , ë„“ì€ ë²”ìœ„ì˜ ì˜ˆì™¸ë„ ê³ ë ¤í•˜ëŠ” ê²Œ ì¢‹ìŒ
- `conn.rollback()`ì€ ë°˜ë“œì‹œ `catch` ë¸”ë¡ì—ì„œ ì•ˆì „í•˜ê²Œ í˜¸ì¶œí•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„í•´ì•¼ í•¨

------

### âœ… 5. savepoint (ì¤‘ê°„ ì§€ì  ì„¤ì •)

ì—¬ëŸ¬ ë‹¨ê³„ ì¤‘ ì¼ë¶€ë§Œ ë¡¤ë°±í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©

```
conn.setAutoCommit(false);
Savepoint savepoint1 = conn.setSavepoint();

try {
    // ì²« ì‘ì—…
    ...

    // ë‘ ë²ˆì§¸ ì‘ì—…
    Savepoint savepoint2 = conn.setSavepoint();

    // ì˜¤ë¥˜ ë°œìƒ
    conn.rollback(savepoint2); // savepoint2 ì´í›„ ì‘ì—…ë§Œ ì·¨ì†Œ

    conn.commit(); // ì •ìƒ ì²˜ë¦¬ëœ ê²ƒë§Œ ë°˜ì˜
} catch (SQLException e) {
    conn.rollback(); // ì „ì²´ ë¡¤ë°±
}
```

------

### âœ… 6. íŠ¸ëœì­ì…˜ì´ í•„ìš”í•œ ëŒ€í‘œì ì¸ ì‘ì—…ë“¤

| ì‘ì—… ì¢…ë¥˜      | íŠ¸ëœì­ì…˜ í•„ìš” ì—¬ë¶€                    |
| -------------- | ------------------------------------- |
| ì‚¬ìš©ì ê°€ì…    | âœ… (íšŒì›ì •ë³´ + ì´ˆê¸° ì„¤ì • ë“±ë¡ ë“±)      |
| ìƒí’ˆ ì£¼ë¬¸      | âœ… (ì£¼ë¬¸ + ì¬ê³  ê°ì†Œ + ê²°ì œ ë‚´ì—­ ë“±ë¡) |
| ê²Œì‹œíŒ ê¸€ ì‚­ì œ | âœ… (ê¸€ + ëŒ“ê¸€ + ì²¨ë¶€íŒŒì¼ ì¼ê´„ ì‚­ì œ)    |

------

### âœ… 7. JDBC ì™¸ì˜ ê³ ê¸‰ íŠ¸ëœì­ì…˜ ì²˜ë¦¬ ë„êµ¬

| ë„êµ¬                              | ì„¤ëª…                                    |
| --------------------------------- | --------------------------------------- |
| **Spring TransactionManager**     | ì„ ì–¸ì  íŠ¸ëœì­ì…˜ ì§€ì› (`@Transactional`) |
| **JTA (Java Transaction API)**    | ë¶„ì‚° íŠ¸ëœì­ì…˜ ì²˜ë¦¬ ì§€ì›                 |
| **Connection Pool (HikariCP ë“±)** | íŠ¸ëœì­ì…˜ê³¼ ì»¤ë„¥ì…˜ì˜ íš¨ìœ¨ì  ê´€ë¦¬ ì§€ì›    |

## ResultSet ì²˜ë¦¬

JDBCì—ì„œ **`ResultSet`** ì€ `SELECT` ì¿¼ë¦¬ì˜ ê²°ê³¼ë¥¼ ë‹´ê³  ìˆëŠ” ê°ì²´ë¡œ, **DBì—ì„œ ê°€ì ¸ì˜¨ ë°ì´í„° í–‰(row)ë“¤ì„ íƒìƒ‰í•  ìˆ˜ ìˆë„ë¡** í•´ì¤€ë‹¤. ê²°ê³¼ ì§‘í•©ì˜ ê° í–‰ì€ ì»¤ì„œ(cursor)ë¡œ í•˜ë‚˜ì”© ìˆœíšŒí•˜ë©° ì ‘ê·¼í•œë‹¤.

------

### âœ… 1. ResultSetì˜ ê¸°ë³¸ êµ¬ì¡°

```
String sql = "SELECT id, name, email FROM users";
Connection conn = DriverManager.getConnection(...);
Statement stmt = conn.createStatement();
ResultSet rs = stmt.executeQuery(sql); // SELECT ì¿¼ë¦¬ ì‹¤í–‰

while (rs.next()) {
    int id = rs.getInt("id");
    String name = rs.getString("name");
    String email = rs.getString("email");

    System.out.println(id + ", " + name + ", " + email);
}

rs.close();
stmt.close();
conn.close();
```

------

### âœ… 2. ì»¤ì„œì˜ ê°œë…

- `rs.next()` í˜¸ì¶œ ì‹œ, ì»¤ì„œê°€ ë‹¤ìŒ í–‰ìœ¼ë¡œ ì´ë™
- ì»¤ì„œ ìœ„ì¹˜ëŠ” ì²˜ìŒì—” 0ë²ˆì§¸(ì²« í–‰ ì´ì „)ì— ìˆìŒ
- `next()`ëŠ” **boolean** ë°˜í™˜: ë‹¤ìŒ í–‰ì´ ìˆìœ¼ë©´ `true`, ì—†ìœ¼ë©´ `false`

------

### âœ… 3. ê°’ ê°€ì ¸ì˜¤ê¸° ë©”ì„œë“œ

| ë©”ì„œë“œ                 | ì„¤ëª…                                  |
| ---------------------- | ------------------------------------- |
| `getInt("ì»¬ëŸ¼ëª…")`     | ì •ìˆ˜ ê°’ ê°€ì ¸ì˜¤ê¸°                      |
| `getString("ì»¬ëŸ¼ëª…")`  | ë¬¸ìì—´ ê°€ì ¸ì˜¤ê¸°                       |
| `getBoolean("ì»¬ëŸ¼ëª…")` | ë¶ˆë¦¬ì–¸ ê°€ì ¸ì˜¤ê¸°                       |
| `getDouble("ì»¬ëŸ¼ëª…")`  | ì‹¤ìˆ˜ ê°’ ê°€ì ¸ì˜¤ê¸°                      |
| `getDate("ì»¬ëŸ¼ëª…")`    | `java.sql.Date` ê°ì²´ ê°€ì ¸ì˜¤ê¸°         |
| `getObject("ì»¬ëŸ¼ëª…")`  | ë‹¤í˜•ì ì¸ ë°©ì‹ìœ¼ë¡œ ê°ì²´í˜•ìœ¼ë¡œ ê°€ì ¸ì˜¤ê¸° |

> ì»¬ëŸ¼ ì´ë¦„ ëŒ€ì‹  ì¸ë±ìŠ¤ë„ ê°€ëŠ¥ (1ë¶€í„° ì‹œì‘): `getString(2)`

------

### âœ… 4. ì˜ˆì™¸ì™€ ì£¼ì˜ì 

- `rs.getXXX("ì»¬ëŸ¼ëª…")`ì—ì„œ **ì»¬ëŸ¼ëª…ì´ ì˜ëª»ë˜ë©´ `SQLException` ë°œìƒ**
- ë„ê°’ ì²˜ë¦¬ ì‹œ `wasNull()` ì‚¬ìš©:

```
int age = rs.getInt("age");
if (rs.wasNull()) {
    age = -1; // ë˜ëŠ” null ì²˜ë¦¬
}
```

------

### âœ… 5. ResultSet íƒ€ì… ì¢…ë¥˜ (ì˜µì…˜ ì„¤ì •)

ê¸°ë³¸ì ìœ¼ë¡œëŠ” ë‹¨ë°©í–¥ìœ¼ë¡œ í•œ ë²ˆë§Œ ìˆœíšŒ ê°€ëŠ¥í•˜ì§€ë§Œ, ë‹¤ìŒê³¼ ê°™ì€ ì„¤ì •ë„ ê°€ëŠ¥í•˜ë‹¤:

```
Statement stmt = conn.createStatement(
    ResultSet.TYPE_SCROLL_INSENSITIVE,
    ResultSet.CONCUR_READ_ONLY
);
```

| ì˜µì…˜                      | ì„¤ëª…                                    |
| ------------------------- | --------------------------------------- |
| `TYPE_FORWARD_ONLY`       | (ê¸°ë³¸) ìˆœë°©í–¥ë§Œ ê°€ëŠ¥                    |
| `TYPE_SCROLL_INSENSITIVE` | ì»¤ì„œ ììœ  ì´ë™ ê°€ëŠ¥, DB ë³€ê²½ ë°˜ì˜ ì•ˆ ë¨ |
| `TYPE_SCROLL_SENSITIVE`   | ì»¤ì„œ ììœ  ì´ë™ ê°€ëŠ¥, DB ë³€ê²½ ë°˜ì˜ë¨     |
| `CONCUR_READ_ONLY`        | ì½ê¸° ì „ìš©                               |
| `CONCUR_UPDATABLE`        | ìˆ˜ì • ê°€ëŠ¥ ResultSet                     |

------

### âœ… 6. ì»¤ì„œ ì´ë™ ë©”ì„œë“œ (Scroll ê°€ëŠ¥í•œ ê²½ìš°)

```
rs.absolute(5); // 5ë²ˆì§¸ í–‰ìœ¼ë¡œ ì´ë™
rs.beforeFirst(); // ì²˜ìŒìœ¼ë¡œ ì´ë™
rs.afterLast();   // ë§ˆì§€ë§‰ ë‹¤ìŒìœ¼ë¡œ ì´ë™
rs.previous();    // ì´ì „ í–‰ìœ¼ë¡œ ì´ë™
rs.first();       // ì²« í–‰ìœ¼ë¡œ ì´ë™
rs.last();        // ë§ˆì§€ë§‰ í–‰ìœ¼ë¡œ ì´ë™
```

------

### âœ… 7. ResultSet â†’ ê°ì²´ ë§¤í•‘ ì˜ˆì‹œ (DTO ë§¤í•‘)

```
class User {
    int id;
    String name;
    String email;
    // ìƒì„±ì, getter, setter ë“±
}

List<User> users = new ArrayList<>();

while (rs.next()) {
    User user = new User();
    user.setId(rs.getInt("id"));
    user.setName(rs.getString("name"));
    user.setEmail(rs.getString("email"));
    users.add(user);
}
```

------

### âœ… 8. ë§ˆë¬´ë¦¬: ë¦¬ì†ŒìŠ¤ í•´ì œ í•„ìˆ˜

```
rs.close();
stmt.close();
conn.close();
```

ìì›ì„ ë‹«ì§€ ì•Šìœ¼ë©´ ì»¤ë„¥ì…˜ ëˆ„ìˆ˜ ë°œìƒ â†’ ì»¤ë„¥ì…˜ í’€ ì‚¬ìš© ì‹œ ì‹¬ê°í•œ ì¥ì•  ìœ ë°œ ê°€ëŠ¥

------

### âœ… ì°¸ê³ : ResultSetMetaData

ê²°ê³¼ì˜ ì»¬ëŸ¼ ê°œìˆ˜ë‚˜ ì»¬ëŸ¼ëª… ë“±ì„ ë™ì ìœ¼ë¡œ í™•ì¸í•  ë•Œ ì‚¬ìš©

```
ResultSetMetaData meta = rs.getMetaData();
int columnCount = meta.getColumnCount();

for (int i = 1; i <= columnCount; i++) {
    System.out.println(meta.getColumnName(i));
}
```

## DB ì»¤ë„¥ì…˜ í’€ (HikariCP ë“±)

### âœ… DB ì»¤ë„¥ì…˜ í’€(Connection Pool)ì´ë€?

#### ğŸ“Œ ê°œë…

DB ì»¤ë„¥ì…˜ í’€ì€ **DB ì—°ê²° ê°ì²´(Connection)** ë¥¼ ë¯¸ë¦¬ ìƒì„±í•´ë‘ê³ ,
 í•„ìš”í•  ë•Œë§ˆë‹¤ êº¼ë‚´ ì“°ê³  ë‹¤ì‹œ ë°˜ë‚©í•˜ëŠ” **í’€(pool) êµ¬ì¡°**ë¥¼ ë§í•œë‹¤.

```
ê¸°ì¡´ ë°©ì‹: ë§¤ ìš”ì²­ë§ˆë‹¤ DB ì—°ê²° â†’ ì„±ëŠ¥ ì €í•˜
í’€ ë°©ì‹: ë¯¸ë¦¬ ë§Œë“¤ì–´ë‘” ì»¤ë„¥ì…˜ ì¬ì‚¬ìš© â†’ ê³ ì„±ëŠ¥
```

#### ğŸ“Œ ì¥ì 

- DB ì—°ê²°/í•´ì œ ì˜¤ë²„í—¤ë“œ ì œê±°
- íŠ¸ë˜í”½ ê¸‰ì¦ ëŒ€ì‘ë ¥ í–¥ìƒ
- DB ì—°ê²° ìˆ˜ ì œí•œ ì„¤ì • ê°€ëŠ¥
- ì•ˆì •ì ì¸ ì»¤ë„¥ì…˜ ê´€ë¦¬

------

### âœ… ì£¼ìš” ì»¤ë„¥ì…˜ í’€ ë¼ì´ë¸ŒëŸ¬ë¦¬

| ì´ë¦„         | íŠ¹ì§•                                      |
| ------------ | ----------------------------------------- |
| **HikariCP** | ë§¤ìš° ë¹ ë¥´ê³  ê°€ë³ê³ , Spring Boot ê¸°ë³¸ ì±„íƒ |
| Apache DBCP2 | ì•ˆì •ì ì´ì§€ë§Œ ì„±ëŠ¥ì€ HikariCPë³´ë‹¤ ë‚®ìŒ     |
| C3P0         | ì„¤ì •ì´ ë‹¤ì–‘í•˜ì§€ë§Œ ì˜¤ë˜ë¨                  |

> ìµœê·¼ í”„ë¡œì íŠ¸ëŠ” ê±°ì˜ ëŒ€ë¶€ë¶„ **HikariCP** ì‚¬ìš©

------

### âœ… HikariCP ì‚¬ìš©ë²•

#### 1. Maven ì˜ì¡´ì„± ì¶”ê°€

```
<dependency>
    <groupId>com.zaxxer</groupId>
    <artifactId>HikariCP</artifactId>
    <version>5.1.0</version>
</dependency>
```

> Gradle:

```
implementation 'com.zaxxer:HikariCP:5.1.0'
```

------

#### 2. ê¸°ë³¸ ì‚¬ìš© ì˜ˆì‹œ (ìˆœìˆ˜ Java)

```
import com.zaxxer.hikari.HikariConfig;
import com.zaxxer.hikari.HikariDataSource;

import java.sql.Connection;

public class HikariExample {
    public static void main(String[] args) throws Exception {
        HikariConfig config = new HikariConfig();
        config.setJdbcUrl("jdbc:mysql://localhost:3306/testdb");
        config.setUsername("root");
        config.setPassword("password");
        config.setMaximumPoolSize(10);

        HikariDataSource ds = new HikariDataSource(config);

        try (Connection conn = ds.getConnection()) {
            System.out.println("DB ì—°ê²° ì„±ê³µ");
        }

        ds.close(); // ë°˜ë“œì‹œ í•´ì œ
    }
}
```

------

#### 3. ì£¼ìš” ì„¤ì • í•­ëª©

| ì„¤ì •                  | ì„¤ëª…                                 | ê¸°ë³¸ê°’         |
| --------------------- | ------------------------------------ | -------------- |
| `jdbcUrl`             | DB ì ‘ì† URL                          | ì—†ìŒ           |
| `username`            | DB ì‚¬ìš©ìëª…                          | ì—†ìŒ           |
| `password`            | ë¹„ë°€ë²ˆí˜¸                             | ì—†ìŒ           |
| `maximumPoolSize`     | ìµœëŒ€ ì»¤ë„¥ì…˜ ìˆ˜                       | 10             |
| `minimumIdle`         | ìµœì†Œ ìœ íœ´ ì»¤ë„¥ì…˜ ìˆ˜                  | same as max    |
| `idleTimeout`         | ìœ íœ´ ì»¤ë„¥ì…˜ ìœ ì§€ ì‹œê°„ (ms)           | 600000 (10ë¶„)  |
| `connectionTimeout`   | ì»¤ë„¥ì…˜ ì–»ê¸° ëŒ€ê¸° ì‹œê°„ (ms)           | 30000 (30ì´ˆ)   |
| `validationTimeout`   | ì»¤ë„¥ì…˜ ìœ íš¨ì„± ê²€ì‚¬ ì‹œê°„              | 5000           |
| `connectionTestQuery` | ìœ íš¨ì„± ê²€ì‚¬ìš© ì¿¼ë¦¬ (ë³´í†µ `SELECT 1`) | DBë³„ ìë™ ì¶”ë¡  |

------

### âœ… Spring Bootì—ì„œ HikariCP ì‚¬ìš©í•˜ê¸°

**Spring Boot 2.x ì´ìƒì€ ê¸°ë³¸ìœ¼ë¡œ HikariCPê°€ í¬í•¨ë¨**
 â†’ ë³„ë„ ì„¤ì • ì—†ì´ `spring.datasource.*` ë¡œ ìë™ êµ¬ì„±ë¨

#### `application.yml` ì˜ˆì‹œ

```
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/testdb
    username: root
    password: password
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      idle-timeout: 600000
      connection-timeout: 30000
```

------

### âœ… ì»¤ë„¥ì…˜ í’€ í…ŒìŠ¤íŠ¸ ì½”ë“œ

```
@Autowired
DataSource dataSource;

@Test
void ì»¤ë„¥ì…˜í’€_í™•ì¸() throws Exception {
    Connection conn = dataSource.getConnection();
    System.out.println("ì»¤ë„¥ì…˜ í´ë˜ìŠ¤: " + conn.getClass());
    conn.close();
}
```

ì¶œë ¥ ì˜ˆì‹œ:

```
ì»¤ë„¥ì…˜ í´ë˜ìŠ¤: class com.zaxxer.hikari.pool.HikariProxyConnection
```

------

### ğŸ§  ì„±ëŠ¥ ì¸¡ë©´ì—ì„œ ì£¼ì˜í•  ì 

- `maximumPoolSize`ë¥¼ ë„ˆë¬´ ì‘ê²Œ ì¡ìœ¼ë©´ ëŒ€ê¸° ì‹œê°„ ì¦ê°€
- ë„ˆë¬´ í¬ê²Œ ì¡ìœ¼ë©´ DB ì—°ê²° ê³¼ë¶€í•˜
- ì ì ˆí•œ ì„¤ì •ì€ **TPS, DB ë™ì‹œ ì²˜ë¦¬ ëŠ¥ë ¥, CPU/ë©”ëª¨ë¦¬ ì—¬ìœ ** ê³ ë ¤ í•„ìš”

------

### ğŸ“¦ ìš”ì•½

| í•­ëª©        | ì„¤ëª…                                                     |
| ----------- | -------------------------------------------------------- |
| HikariCP    | ê°€ì¥ ë¹ ë¥´ê³  ê²½ëŸ‰ì˜ ì»¤ë„¥ì…˜ í’€                             |
| ì‚¬ìš© ë°©ì‹   | `HikariDataSource` ì§ì ‘ ìƒì„± ë˜ëŠ” Spring Boot ìë™ ì„¤ì •  |
| ì„¤ì • ì¤‘ìš”ê°’ | `maximumPoolSize`, `idleTimeout`, `connectionTimeout` ë“± |
| ì„±ëŠ¥ í–¥ìƒ   | DB ì—°ê²° ë¹„ìš© ì ˆê°, ì²˜ë¦¬ëŸ‰ ì¦ê°€                           |
| ì‚¬ìš© í™˜ê²½   | Spring Boot, JDBC, JPA ë“± ëª¨ë“  Java DB ì—°ë™ ì‹œìŠ¤í…œ       |